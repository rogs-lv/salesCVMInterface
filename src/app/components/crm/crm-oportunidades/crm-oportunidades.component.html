<div class="ml-5 animated fadeIn fast">
    <div class="row">
        <!-- Sección de formulario -->
        <div class="col-md-8 pt-4">
            <div class="card bxcard">
                <div class="card-body">
                    <div class="progress">
                        <div class="progress-bar bg-info" role="progressbar" style="width: 25%;" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100">25%</div>
                    </div>
                    <div class="container pt-3">
                        <div class="row">
                            <div class="col-sm-12">
                                <form [formGroup]="formOpp">
                                    <div class="row">
                                        <div class="col-sm-4">
                                            <div class="form-group">
                                                <label for="OppName">Nombre Oportunidad</label>
                                                <input id="OppName" type="text" class="form-control" placeholder="Nombre de Oportunidad" formControlName="name" [ngClass]="{ 'is-invalid': (submitted || f.name.errors) && f.name.touched}">
                                                <div *ngIf="(submitted || f.name.errors) && f.name.touched" class="invalid-feedback">
                                                    <div *ngIf="f.name.errors.required">El nombre es requerido</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-sm-4">
                                            <div class="form-group">
                                                <label for="TaxDate">Fecha de Inicio</label>
                                                <div class="input-group mb-3">
                                                    <input class="form-control" placeholder="Fecha" ngbDatepicker #OpenCalendar="ngbDatepicker" readonly formControlName="openDate" [ngClass]="{ 'is-invalid': (submitted || f.openDate.errors)
                                                    && f.openDate.touched}" (dateSelect)="onChangeDate()">
                                                    <div class="input-group-append">
                                                        <button class="btn btn-outline-secondary calendar" (click)="OpenCalendar.toggle()" type="button"><span><i class="fas fa-calendar"></i></span></button>
                                                    </div>
                                                </div>
                                                <div *ngIf="(submitted || f.openDate.errors) && f.openDate.touched" class="invalid-feedback">
                                                    <div *ngIf="f.openDate.errors.required">La fecha es requerida</div>
                                                </div>
                                                <div *ngIf="durationValid === 1" style="color: red; font-size: 80%;">
                                                    <div>La fecha no puede ser mayor que la de cierre</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-sm-4">
                                            <div class="form-group">
                                                <label for="">Fecha cierre</label>
                                                <div class="input-group mb-3">
                                                    <input id="" type="text" class="form-control" placeholder="Fecha Cierre" disabled>
                                                    <div class="input-group-append">
                                                        <button class="btn btn-outline-secondary" type="button" id="btnFecha" disabled><span><i class="fas fa-calendar"></i></span></button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-3">
                                            <div class="form-group">
                                                <label for="CardCode">Cliente</label>
                                                <input id="CardCode" type="text" class="form-control" placeholder="Cliente" disabled formControlName="cardCode" [ngClass]="{ 'is-invalid': (submitted || f.cardCode.errors) && f.cardCode.touched}">
                                                <div *ngIf="(submitted || f.cardCode.errors) && f.cardCode.touched" class="invalid-feedback">
                                                    <div *ngIf="f.cardCode.errors.required">El campo es requerido</div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-sm-5">
                                            <div class="form-group">
                                                <label for="CardName">Nombre</label>
                                                <input id="CardName" type="text" class="form-control" placeholder="Nombre" formControlName="cardName">
                                            </div>
                                        </div>
                                        <div class="col-sm-4">
                                            <div class="form-group">
                                                <label for="CprCode">Persona de Contacto</label>
                                                <select class="form-control" id="CprCode" formControlName="cprCode">
                                                   <option *ngFor="let pc of optsOpp.ListPrsContacto" [ngValue]="pc.CntctCode">{{pc.Name}}</option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-sm-4">
                                            <div class="form-group">
                                                <label for="Territory">Territorio SN</label>
                                                <select class="form-control" id="Territory" formControlName="territory">
                                                    <option *ngFor="let t of optsOpp.ListTerritorio" [ngValue]="t.territryID">{{t.descript}}</option>
                                                </select>
                                            </div>
                                        </div>
                                        <div class="col-sm-4">
                                            <div class="form-group">
                                                <label for="slpCode">Vendedor</label>
                                                <select class="form-control" id="SlpCode" formControlName="slpCode">
                                                    <option *ngFor="let s of optsOpp.ListVendedor" [ngValue]="s.SlpCode">{{s.SlpName}}</option>    
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                    <br>
                                    <!-- Sección de tabs -->
                                    <div class="row">
                                        <div class="col-sm-12">
                                            <ul class="nav nav-tabs" id="myTab" role="tablist">
                                                <li class="nav-item">
                                                    <a class="atabs nav-link" id="potencial-tab" data-toggle="tab" href="#potencial" role="tab" aria-controls="potencial" aria-selected="true">
                                                        <span class="icontabs"><i class="fas fa-hand-holding-usd"></i></span> Potencial
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="atabs nav-link" id="general-tab" data-toggle="tab" href="#general" role="tab" aria-controls="general" aria-selected="false">
                                                        <span class="icontabs"><i class="fas fa-id-card-alt"></i></span> General
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="atabs nav-link" id="etapas-tab" data-toggle="tab" href="#etapas" role="tab" aria-controls="etapas" aria-selected="false">
                                                        <span class="icontabs"><i class="fas fa-layer-group"></i></span> Etapas
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="atabs nav-link" id="partner-tab" data-toggle="tab" href="#partner" role="tab" aria-controls="partner" aria-selected="false">
                                                        <span class="icontabs"><i class="fas fa-handshake"></i></span>Partner
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="atabs nav-link" id="competidores-tab" data-toggle="tab" href="#competidores" role="tab" aria-controls="competidores" aria-selected="false">
                                                        <span><i class="fas fa-theater-masks"></i></span> Competidores
                                                    </a>
                                                </li>
                                                <li class="nav-item">
                                                    <a class="atabs nav-link" id="resumen-tab" data-toggle="tab" href="#resumen" role="tab" aria-controls="resumen" aria-selected="false">
                                                        <span class="icontabs"><i class="fas fa-poll-h"></i></span> Resumen
                                                    </a>
                                                </li>
                                            </ul>
                                            <div class="tab-content" id="myTabContent">
                                                <div class="tab-pane fade show active" id="potencial" role="tabpanel" aria-labelledby="potencial-tab">
                                                    <br>
                                                    <div class="row">
                                                        <div class="col-sm-4">
                                                            <div class="form-group">
                                                                <label for="PredDate">Fecha prevista cierre</label>
                                                                <div class="input-group mb-3">
                                                                    <input id="PredDate" type="text" class="form-control" placeholder="Fecha cierre" ngbDatepicker #PredDate="ngbDatepicker" readonly formControlName="predDate" (dateSelect)="onChangeDate()">
                                                                    <div class="input-group-append">
                                                                        <button class="btn btn-outline-secondary" type="button" id="PredDateBtn" (click)="PredDate.toggle()"><span><i class="fas fa-calendar"></i></span></button>
                                                                    </div>
                                                                    <div *ngIf="durationValid === -1" style="color: red; font-size: 80%;">
                                                                        <div>La fecha no puede ser menor que la de inicio</div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-3">
                                                            <div class="form-group text-center">
                                                                <label for="ClosePrev">Cierre previsto</label>
                                                                <p *ngIf="duration > 0 && durationValid === 0"><span>{{duration}} días</span></p>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4">
                                                            <div class="form-group">
                                                                <label for="DMaxSumLoc">Monto Potencial</label>
                                                                <input id="DMaxSumLoc" type="number" class="form-control" placeholder="Monto" formControlName="maxSumLoc" [ngClass]="{ 'is-invalid': (submitted || f.maxSumLoc.errors) && f.maxSumLoc.touched}">
                                                                <p style="margin-left: 0.5em;">{{ f.maxSumLoc.value | currency}}</p>
                                                                <div *ngIf="(submitted || f.maxSumLoc.errors) && f.maxSumLoc.touched" class="invalid-feedback">
                                                                    <div *ngIf="f.maxSumLoc.errors.required">El monto es requerido</div>
                                                                    <div *ngIf="f.maxSumLoc.errors.min">El monto debe ser mayor a 0</div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="tab-pane fade" id="general" role="tabpanel" aria-labelledby="general-tab">
                                                    <br>
                                                    <div class="row">
                                                        <div class="col-sm-4">
                                                            <div class="form-group">
                                                                <label for="ProySN">Proyecto SN</label>
                                                                <select class="form-control" id="ProySN" formControlName="prjCode">
                                                                    <option *ngFor="let ps of optsTabGral.ListProyectoSN" [ngValue]="ps.PrjCode">{{ps.PrjName}}</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4">
                                                            <div class="form-group">
                                                                <label for="Source">Fuente de Información</label>
                                                                <select class="form-control" id="Source" formControlName="source">
                                                                    <option *ngFor="let ps of optsTabGral.ListaInformacion" [ngValue]="ps.Num">{{ps.Descript}}</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4">
                                                            <div class="form-group">
                                                                <label for="Industry">Industria</label>
                                                                <select class="form-control" id="Industry" formControlName="industry">
                                                                    <option *ngFor="let ps of optsTabGral.ListIndustria" [ngValue]="ps.IndCode">{{ps.IndName}} - {{ps.IndDesc}}</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-md-6">
                                                            <div class="form-group">
                                                                <label for="observaciones">Observaciones</label>
                                                                <textarea class="form-control" id="observaciones" placeholder="observaciones" formControlName="memo"></textarea>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="tab-pane fade" id="etapas" role="tabpanel" aria-labelledby="etapas-tab">
                                                    <div class="row">
                                                        <div class="col-sm-4">
                                                            <div class="form-group">
                                                                <label for="">Vendedor</label>
                                                                <select class="form-control" id="exampleFormControlSelect1">
                                                                    <option>Vendedor1</option>
                                                                    <option>Vendedor2</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4">
                                                            <div class="form-group">
                                                                <label for="">Etapas</label>
                                                                <select class="form-control" id="exampleFormControlSelect1">
                                                                    <option>Etp1</option>
                                                                    <option>Etp2</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4">
                                                            <div class="form-group">
                                                                <label for="Montop">Monto Especial</label>
                                                                <input id="Montop" type="number" class="form-control" placeholder="Monto" value="">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-sm-4">
                                                            <div class="form-group">
                                                                <label for="inicio">Inicio</label>
                                                                <input id="inicio" type="number" class="form-control" placeholder="Inicio" value="" disabled>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4">
                                                            <div class="form-group">
                                                                <label for="inicio">Cierre</label>
                                                                <input id="inicio" type="number" class="form-control" placeholder="Inicio" value="" disabled>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4" style="text-align: center;padding-top: 1.5em;">
                                                            <button class="btn btn-light btnLimon"><span class="btnFomr"><i class="fas fa-plus"></i></span></button>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-sm-12">
                                                            <div class="table-responsive-xl">
                                                                <table class="table table-borderless">
                                                                    <thead>
                                                                        <tr>
                                                                            <th>Vendedor</th>
                                                                            <th>Open Date</th>
                                                                            <th>Close Date</th>
                                                                            <th>Etapa</th>
                                                                            <th>%</th>
                                                                            <th>Monto Especial</th>
                                                                            <th>Clase de Doc</th>
                                                                            <th>No Doc</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        <tr>
                                                                            <td>Vendedor1</td>
                                                                            <td>20/08/2020</td>
                                                                            <td>20/08/2020</td>
                                                                            <td>Etapa 1</td>
                                                                            <td>10</td>
                                                                            <td>100</td>
                                                                            <td>Cotización</td>
                                                                            <td>1</td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="tab-pane fade" id="partner" role="tabpanel" aria-labelledby="partner-tab">
                                                    <div class="row">
                                                        <div class="col-sm-4">
                                                            <div class="form-group">
                                                                <label for="">Nombre</label>
                                                                <select class="form-control" id="exampleFormControlSelect1">
                                                                    <option>Vendedor1</option>
                                                                    <option>Vendedor2</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4">
                                                            <div class="form-group">
                                                                <label for="Montop">SN Relación</label>
                                                                <input id="Montop" type="number" class="form-control" placeholder="Monto" value="">
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4">
                                                            <div class="form-group">
                                                                <label for="">Relacion</label>
                                                                <select class="form-control" id="exampleFormControlSelect1">
                                                                    <option>Etp1</option>
                                                                    <option>Etp2</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-md-6">
                                                            <div class="form-group">
                                                                <label for="observaciones">Observaciones</label>
                                                                <textarea class="form-control" id="observaciones" placeholder="observaciones"></textarea>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4">
                                                            <div class="form-group text-center">
                                                                <button class="btn btn-light btnLimon"><span class="btnFomr"><i class="fas fa-plus"></i></span></button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-sm-12">
                                                            <div class="table-responsive-xl">
                                                                <table class="table table-borderless">
                                                                    <thead>
                                                                        <tr>
                                                                            <th>Nombre</th>
                                                                            <th>Relación</th>
                                                                            <th>SN Relacionado</th>
                                                                            <th>Comentarios</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        <tr>
                                                                            <td>Carlos </td>
                                                                            <td>Uno</td>
                                                                            <td>SC1</td>
                                                                            <td>Comentario</td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="tab-pane fade" id="competidores" role="tabpanel" aria-labelledby="competidores-tab">
                                                    <div class="row">
                                                        <div class="col-sm-4">
                                                            <div class="form-group">
                                                                <label for="">Nombre</label>
                                                                <select class="form-control" id="exampleFormControlSelect1">
                                                                    <option>1</option>
                                                                    <option>2</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4">
                                                            <div class="form-group">
                                                                <label for="">Nivel Amenaza</label>
                                                                <select class="form-control" id="exampleFormControlSelect1">
                                                                    <option>Amenza1</option>
                                                                    <option>Amenaza2</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4">
                                                            <div class="form-group">
                                                                <label for="">Ganado</label>
                                                                <input type="checkbox" class="form-control">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-md-6">
                                                            <div class="form-group">
                                                                <label for="observaciones">Comentario</label>
                                                                <textarea class="form-control" id="observaciones" placeholder="observaciones"></textarea>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4">
                                                            <div class="form-group text-center">
                                                                <button class="btn btn-light btnLimon"><span class="btnFomr"><i class="fas fa-plus"></i></span></button>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-sm-12">
                                                            <div class="table-responsive-xl">
                                                                <table class="table table-borderless">
                                                                    <thead>
                                                                        <tr>
                                                                            <th>Nombre</th>
                                                                            <th>Relación</th>
                                                                            <th>SN Relacionado</th>
                                                                            <th>Comentarios</th>
                                                                        </tr>
                                                                    </thead>
                                                                    <tbody>
                                                                        <tr>
                                                                            <td>Carlos </td>
                                                                            <td>Uno</td>
                                                                            <td>SC1</td>
                                                                            <td>Comentario</td>
                                                                        </tr>
                                                                    </tbody>
                                                                </table>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="tab-pane fade" id="resumen" role="tabpanel" aria-labelledby="resumen-tab">
                                                    <div class="row">
                                                        <div class="col-sm-4">
                                                            <div class="form-group">
                                                                <label for="">Estatus</label>
                                                                <select class="form-control" id="exampleFormControlSelect1">
                                                                    <option>1</option>
                                                                    <option>2</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4">
                                                            <div class="form-group">
                                                                <label for="">Razones</label>
                                                                <select class="form-control" id="exampleFormControlSelect1">
                                                                    <option>1</option>
                                                                    <option>2</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-sm-4">
                                                            <div class="form-group">
                                                                <label for="">Tipo Docto</label>
                                                                <select class="form-control" id="exampleFormControlSelect1">
                                                                    <option>1</option>
                                                                    <option>2</option>
                                                                </select>
                                                            </div>
                                                        </div>
                                                        <div class="col-sm-4">
                                                            <div class="form-group">
                                                                <label for="">No. Docto</label>
                                                                <input id="Montop" type="number" class="form-control" placeholder="No. Docto" value="">
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <br>
                                    <div class="row pt-4">
                                        <div class="col-sm-6 d-flex justify-content-center">
                                            <button class="btn btn-light btnLimon"><span class="btnFomr"><i class="fas fa-pencil-alt"></i></span></button>
                                            <!-- <button class="btn btn-light btnLimon"><span><i class="fas fa-times"></i></span></button> -->
                                        </div>
                                        <div class="col-sm-6 d-flex justify-content-center">
                                            <button class="btn btn-light btnLimon" (click)="CreateOpp()"><span class="btnFomr"><i class="fas fa-paper-plane"></i></span></button>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Sección de listas -->
        <div class="col-sm-4 pt-4">
            <!--Lista de Oportunidades-->
            <div class="card bxcard">
                <div class="card-header">
                    <div class="card-iconCRM">
                        <span style="font-size: 1.5em; color: white;"><i class="fas fa-money-check-alt"></i> Oportunidades de Vta</span>
                    </div>
                </div>
                <div class="card-body">
                    <div class="container">
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="table-responsive-xl">
                                    <table class="table table-borderless">
                                        <thead>
                                            <tr>
                                                <th scope="col">No Oport.</th>
                                                <th scope="col">Nombre</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <th scope="row">1</th>
                                                <td>Oportunidad 1</td>
                                            </tr>
                                            <tr>
                                                <th scope="row">2</th>
                                                <td>Oportunidad 2</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Lista Socios de Artículos -->
            <div class="card bxcard mt-5">
                <app-lista-crm-socios (socioSel)="listenPartner($event)"></app-lista-crm-socios>
            </div>
        </div>
    </div>
</div>